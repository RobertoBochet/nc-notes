\chapter{Feedback linearization}

\section{Definition}

Given a nonlinear system in the form

\[
    \begin{cases}
        \dx =\vect a(\x) + \vect b(\x) u \\
        y = \vect c(\x)
    \end{cases}
\]

design a static state feedback control law $u = k(\x,v)$ such that the associated feedback system is linear.

\begin{nb} the system is linear w.r.t. input \end{nb}

\begin{example}
    Model of a centrifuge

    \[
        J \ddot\theta = -k \dot \theta^2 \sgn(\dot \theta) + u
    \]

    setting $x = \dot\theta$ the system can be written

    \[
    \begin{cases}
        \dot x = - \frac{k}{J} x^2 \sgn(x) + \frac{1}{J} u \\
        y = x
    \end{cases}
    \]

    if we set $v = - \frac{k}{J}x^2 \sgn(x) + \frac{1}{J}u$ the system become

    \[
    \begin{cases}
        \dot x = v \\
        y = x
    \end{cases}
    \]

    the feedback system seen from outside seems linear, and a controller for linear system can be made using the input $v$ and the output $y$.
\end{example}



\section{Conditions}

\begin{theorem}
    A \texbf{full feedback linearization} of a nonlinear system is possible if and only if a regular function $c(\cdot)$ can be found such that system
    \[
        \begin{cases}
            \dx = \vect a(\x) + \vect b(\x) u \\
            y = \vect c(\x)
        \end{cases}
    \]
    has a \textbf{relative degree} $r$ equal to the order $n$ of the linear system.
\end{theorem}

\subsection{Relative degree}

Given a system with output $y=\vect c(\x)$ its relative degree is defined as the minimum amount time derivation of $y$ such that it is directly dependent by input $u$.

\[
    r = \min \left\{ \gamma : \pd{y^{(\gamma)}}{u} \neq 0 \right\}
\]

The concept of relative degree can be formulated also exploiting the \textbf{Lie derivative}\footnote{Defined as $\mathcal{L}_f h(\x) = \pd{h}{\x} f(\x) = \sum_{i=1}^{n} f_i(\x) \pd{h(\x)}{x_i}$}

\[
    \dot y =
    %\frac{d}{dt} \vect c(\x) =
    \pd{\vect c}{\x} \dx =
    \pd{\vect c}{\x} \left(\vect a(\x) + \vect b(\x) u\right) =
    \mathcal{L}_{\vect a} \vect c(\x) + u \mathcal{L}_{\vect b} \vect c(\x)
\]

if $\mathcal{L}_{\vect b} \vect c(\x) \neq 0$ so the relative degree of the system is equal to $1$ else it is greater than $1$ or not well-defined;
in this case we can iterate the derivation of the output in order to find the relative degree.

Since $\mathcal{L}_{\vect b} \vect c(\x) = 0$ then $\dot y = \mathcal{L}_{\vect a} \vect c(\x)$ and

\[
    \ddot y =
    %\frac{d}{dt} \left( \mathcal{L}_{\vect a} \vect c(\x) \right) =
    \pd{\left( \mathcal{L}_{\vect a} \vect c(\x) \right)}{x} \dx =
    \pd{\left( \mathcal{L}_{\vect a} \vect c(\x) \right)}{x} \left(\vect a(\x) + \vect b(\x) u\right) =
    \mathcal{L}_{\vect a}^2 \vect c(\x) + u \mathcal{L}_{\vect b} \mathcal{L}_{\vect a} \vect c(\x)
\]

now if $\mathcal{L}_{\vect b} \mathcal{L}_{\vect a} \vect c(\x) \neq 0$ then the relative degree is $2$ else we can go on with the iterations.

The procedure can be generalized

\[
    y^{(k)} = \mathcal{L}_{\vect a}^k \vect c(\x) + u \mathcal{L}_{\vect b} \mathcal{L}_{\vect a}^{k-1} \vect c(\x) \qquad \Longleftarrow \mathcal{L}_{\vect b} \mathcal{L}_{\vect a}^{h-1} \vect c(\x) = 0, h < k
\]

so the relative degree can be defined as

\[
    r = \min \left\{ \gamma : \mathcal{L}_{\vect b} \mathcal{L}_{\vect a}^{\gamma-1} \vect c(\x) \neq 0 \right\}
\]
