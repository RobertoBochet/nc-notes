\chapter{Variable structure control}

\section{Definition}

\begin{figure}[htb]
    \centering
    \resizebox{0.7\textwidth}{!}{
        \begin{tikzpicture}
            \node [sum] (sum_e) {};

            \node [block, right=1cm of sum_e] (controller) {$\psi(\cdot)$};
            \node [block, above=1cm of controller] (switching_law) {$s(\cdot) > 0$};
            \node [block, right=1cm of controller] (system) {$G(s)$};

            \node [output, right=1cm of system] (oy) {};

            \draw [->] (sum_e) -- node {$e$} (controller);
            \draw [->] (switching_law) -- (controller);
            \draw [->] (controller) -- node {$u$} (system);
            \draw [->] (system) |- node [pos=0.8] {$x$} (switching_law);
            \draw [->] (system) -- node [pos=0.8] {$y$} node [node, name=y, pos=0.5] {} (oy);

            \draw [->] (y) -- ++(0,-1.5) -| node [pos=0.95] {$-$} (sum_e);
        \end{tikzpicture}
    }
    \caption{Example of VSC}
    \label{fig:vsc-example}
\end{figure}

In \cref{fig:vsc-example} is shown an example of the structure of a typical \textbf{VSC}, in particular we have a piecewise control law, based on the switching function $s(x) > 0$.

\[
    \psi(e) = \begin{cases}
                  \varphi_1(e), \qquad s(x) > 0 \\
                  \varphi_2(e), \qquad s(x) < 0
              \end{cases}
\]

given this control law we get two different overall systems, one based on the control law for $s(x)>0$ and one for $s(x)<0$ (\cref{fig:vcs-two-systems}).

\begin{figure}[htb]
    \centering
    \begin{subfigure}[b]{0.45\textwidth}
        \resizebox{\textwidth}{!}{
            \begin{tikzpicture}
                \node [sum] (sum_e) {};

                \node [block, right=1cm of sum_e] (controller) {$\varphi_1(\cdot)$};
                \node [block, right=1cm of controller] (system) {$G(s)$};

                \node [output, right=1cm of system] (oy) {};

                \draw [->] (sum_e) -- node {$e$} (controller);
                \draw [->] (controller) -- node {$u$} (system);
                \draw [->] (system) -- node [pos=0.8] {$y$} node [node, name=y, pos=0.5] {} (oy);

                \draw [->] (y) -- ++(0,-1.5) -| node [pos=0.95] {$-$} (sum_e);
            \end{tikzpicture}
        }
        \caption{$s(x)>0$}
        \label{fig:vcs-two-systems-a}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.45\textwidth}
        \resizebox{\textwidth}{!}{
            \begin{tikzpicture}
                \node [sum] (sum_e) {};

                \node [block, right=1cm of sum_e] (controller) {$\varphi_2(\cdot)$};
                \node [block, right=1cm of controller] (system) {$G(s)$};

                \node [output, right=1cm of system] (oy) {};

                \draw [->] (sum_e) -- node {$e$} (controller);
                \draw [->] (controller) -- node {$u$} (system);
                \draw [->] (system) -- node [pos=0.8] {$y$} node [node, name=y, pos=0.5] {} (oy);

                \draw [->] (y) -- ++(0,-1.5) -| node [pos=0.95] {$-$} (sum_e);
            \end{tikzpicture}
        }
        \caption{$s(x)<0$}
        \label{fig:vcs-two-systems-b}
    \end{subfigure}
    \caption{The two systems under the switching law}
    \label{fig:vcs-two-systems}
\end{figure}

\begin{nb}the stability of the two systems tells us nothing about the stability of the overall one\end{nb}

Considering the vector fields drive the evolution of the states of the two systems (\cref{fig:vcs-two-systems}), the switching law defines a new piecewise vector field merging these two.

The inside boundaries of the new piecewise vector field can be of two kinds:

\begin{itemize}
    \item Across switching surface

    the state reaches the boundary while following some dynamics, crosses it, and continues its evolution according to the other dynamics

    \item Attractive switching surface

    the state reaches the boundary and cannot leave it because the vector fields on both sides are pointing towards the boundary;
    the state can evolve only sliding along the boundary, the system lose a dof (sliding mode)
\end{itemize}

\section{Design}

Given a linear time-invariant SISO system of order $n$ with $(A,B)$ controllable and $(A,C)$ observable, we want design a variable structure controller such that $y(t)$ tends to some (constant) reference signal $\bar y^0$ in some reasonable amount of time, for all $\bar y^0$ and for all possible initial state.

Suppose to put in the controllable canonical form the linear system, so the system can be define as

\[
    \begin{cases}
        \dx_i = x_{i+1}, \qquad i = 1,2,\dots, n-1 \\
        \dx_n = - a_n x_1 - a_{n-1} x_2 - \dots - a_1 x_n + u \\
        y = b_n x_1 + b_{n-1} x_2 + \dots + b_1 x_n
    \end{cases}
\]

\subsection{Design the switching function}

A possible choice for the switching function can be

\[
    s(x) = \beta_{n-1} x_1 + \beta_{n-2} x_2 + \dots + \beta_1 x_{n-1} + x_n - \bar w
\]

on the boundary $s(x)=0$ the system is subjected to the constraint

\[
    x_n = - \beta_{n-1} x_1 - \beta_{n-2} x_2 - \dots - \beta_1 x_{n-1} + \bar w
\]

so, the overall system became

\[
    \begin{cases}
        \dx_i = x_{i+1}, \qquad i = 1,2,\dots, n-2 \\
        \dx_{n-1} = x_n = - \beta_{n-1} x_1 - \beta_{n-2} x_2 - \dots - \beta_1 x_{n-1} + \bar w \\
        y = b_n x_1 + b_{n-1} x_2 + \dots + b_1 x_n
    \end{cases}
\]

this system has the characteristic polynomial defined as

\[
    \chi(s) = s^{n-1} + \beta_1 s^{n-2} + \dots + \beta_{n-1}
\]

which roots can be arbitrarily assigned such that the system became asymptotically stable with a single equilibrium defined as

\[
    \begin{cases}
        \bar x_i = 0, \qquad i = 2,3,\dots, n-1 \\
        \bar x_1 = \frac{\bar w}{\beta_{n-1}} \\
        \bar y = b_n \bar x_1
    \end{cases}
\]

and imposing $\bar w = \frac{\beta_{n-1}}{b_n} \bar y^0$ we get $\bar y = \bar y^0$.

So, the switching law drives the state from any point of $s(x)=0$ to the equilibrium $\bar y = \bar y^0$ following an arbitrary dynamic.